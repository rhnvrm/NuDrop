<!DOCTYPE html>
<html>
<head>
    <title>Metamask signer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>
<body>
    
    <section class="section">
        <div class="container">
          <h1 class="title">
            NuDrop
          </h1>
          <p class="subtitle">
            Yet another FOSS Securedrop using the NuCypher network!
          </p>
        </div>
        <nav>
          <h1>NuDrop</h1>
          <ul>
              <li><a href="/">Home</a></li>
          </ul>
        </nav>
        <section class="content">
            <div id="app">
                User Address: {{ user_address }}
            </div>
        </section>
    </section>

    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>

    <script type="text/javascript" charset="utf-8">
        var app = new Vue({
            el: '#app',
            data: {
                user_address: "pending",
            }
        })

        // TODO: Make sure you show if metamask is not there
        ethereum = window.ethereum

        const socket = io();

        socket.emit('on_load', {});

        socket.on('prompt_login', (data) => {
            var _ = async() => {
                let result = await 
                console.log(result)
            }
            ethereum.request({ method: 'eth_requestAccounts' }).then(function(data) {
                app.user_address = data[0] || "Not available"
            })
        });


    </script>
</body>
</html>